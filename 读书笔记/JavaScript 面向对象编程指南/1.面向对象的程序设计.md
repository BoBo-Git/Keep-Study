# 面向对象的程序设计

在面向对象程序设计（OOP）当中，最常用到的概念如下：

- 对象、方法、属性
- 类
- 封装
- 聚合
- 重用与继承
- 多态

接下来，我们将会对这些概念进行逐一阐述。

## 对象

> 对象，实质上是指"事物"（包括人和物）在程序设计语言中的表现形式。这里的"事物"可以是任何东西（如某个客观存在的对象，或者某些较为抽象的概念）。

以猫🐈来举例，它有一些鲜明的特征（如颜色、名字、体型等），它能执行某些动作（如喵喵叫、睡觉、躲起来、逃跑等）。在 OOP 语义中，这些对象特征就叫做==属性==，而那些动作就称之为==方法==。

用口语化的方式来类比的话：

- 对象往往是用名词来表示的（如 book、person）
- 方法一般都是一些动词（如 read、run）
- 属性值则往往是一些形容词

```javascript
/**
* 用对象的写法来表示句子：
* The black cat sleeps on my head.
*/

const cat = {
  color: 'black', // 颜色
  state: 'on my head', // 状态(可以作为限定条件，以参数传递给动作)
  sleeps (state) { // 动作
    return state
  }
}
```

## 类

在现实生活中，我们往往会把一些组成特征相似的事物归为一类。比如鸽子、老鹰都有鸟类的特征，所以我们把它们统称为鸟类。在 OOP 中，类实际上就是对象的设计蓝图或者制作配方。==对象==这个词，我们有时候也叫做==实例==，所以我们可以说鸽子是鸟类的一个实例。

> 类，可以说更多的像是一种模板，对象就是在这些模板的基础上被创建出来的。所以我们可以基于相同的类，创建出许多不同的对象。

但是需要注意的是，JavaScript 与 C++、Java 这种传统的面向对象语言不同，它实际上根本就没有类。<u>JavaScript 的一切都是基于对象的，它所依靠的一套原型系统（原型 prototype）实际上也是一种对象。</u>在做法的描述上区别如下：

- 传统的面向对象 => 我基于 Person 类创建了一个叫做 BoBo 的新对象。
- 基于原型的面向对象 => 我将现有的 Person 对象扩展成了一个叫做 BoBo 的新对象。

## 封装

封装主要用于阐述对象中所包含（或封装）的内容，它们通常由两部分组成：

- 相关的数据（用于存储属性）
- 基于这些数据所能做的事（所能调用的方法）

除此之外，封装这个术语中还包含了一层隐藏信息的概念，这完全是另一方面的问题。因此，我们在理解这个概念时，必须要留意它在具体的 OOP 语境中的含义。

以一个MP3播放器为例。如果假设这是一个对象，那么作为该对象的用户，我们无疑需要一些类似于像按钮、显示屏这样的工作接口。这些接口能帮助我们使用该对象（如播放歌曲之类）。至于它们内部是如何工作的，我们并不清楚，而且多数情况下也不会在乎这些。换句话说，这些接口的时下对我们来说是不可见的。同样的，在 OOP 中也是如此。当我们在代码中调用一个对象的方法时，无论该对象是来自我们自己的实现还是某个第三方库，我们都不需要知道该方法是如何工作的。在编译型语言中，我们甚至都无法查看这些对象的工作代码。而由于 JavaScript 是一种解释型语言，源代码是可以查看的。但至少在这个概念上它们是一致的，即我们只需要知道所操作对象的接口，而不必去关心它的具体实现。

```javascript
/**
* MP3播放器
*/
const MP3 = {
  isPlay: false, // 状态：是否在播放
  play() {}, // 播放歌曲的方法...
  next() {}, // 切换下一首的方法...
  prev() {} // 切换上一首的方法...
}

// 使用的时候,不用在乎方法内部的实现
MP3.play()
MP3.next()
MP3.prev()
```

关于信息隐藏，还有另一方面内容，即方法与属性的可见性。在某些语言中，我们能通过 public、private、protected 这些关键字来限定方法和属性的可见性。这种限定分类定义了对象用户所能访问的层次。例如，private 方法只有其所在对象内部的代码才有权访问，而 public 方法则是任何人都能访问的。在 JavaScript 中，尽管所有的方法和属性都是 public 的，但是我们将会看到，该语言还是提供了一些隐藏数据的方法，以保护程序隐秘性。

## 聚合

> 聚合，有时候也叫做组合，实际上是指我们将几个现有对象合并成一个新对象的过程。

总之，这个概念所强调的就是这种将多个对象合而为一的能力。通过聚合这种强有力的方法，我们可以将一个问题分解成多个更小的问题。这样一来，问题就会显得更易于管理。

```javascript
/**
* 个人电脑是一个非常复杂的对象,为了更容易理解它启动时发生的所有事情，我们可以将它细化为几个对象
*/
const screen = {} // 显示器对象

const mouse = {} // 鼠标对象

const keyboard = {} // 键盘对象

// 将 screen、mouse、keyboard 组合起来就形成了 computer
const computer = {
  screen: {},
  mouse: {},
  keyboard: {}
}
```

## 继承

通过继承这种方式，我们可以非常优雅地实现对现有代码的重用。

> 在传统的 OOP 环境中，继承通常指的是类与类之间的关系，但由于 JavaScript 中不存在类，因此继承只能发生在对象之间。

```javascript
function Person(name, age, birthday) {
  this.name = name
  this.age = age
  this.birthday = birthday
  this.talk = function() {
    console.log('嘿嘿嘿')
  } // 说点什么
  this.do = function() {} // 做点什么
  this.walk = function() {} // 走路
  this.run = function() {} // 跑步
}

// 创建一个新的 Programmer 对象，需要有编码能力
let Programmer = new Person('name', 'age', 'birthday')
Programmer.code = function () {} // 新增编码能力，同时也有基本的 talk、do、walk、run 能力
Programmer.talk = function () {
  console.log('哈哈哈')
} // 也可以在新对象上覆写原始对象的方法，但不影响原始对象的方法
```

## 多态

多态就是不同对象通过相同的方法调用来实现各自行为的能力。（内容待扩充）

## OOP 概述

用个表格来复习下以上概念。

| 特征描述                                                     | 相应概念                  |
| ------------------------------------------------------------ | ------------------------- |
| 小白是一只猫（猫是一个对象）                                 | 对象                      |
| 小白的颜色是白色的，体重10 kg                                | 属性                      |
| 小白能吃饭、睡觉、跑、跳、咬、挠                             | 方法                      |
| 小白是 Cat 类的一个实例                                      | 传统 OOP 中的类           |
| 小白是一个由 Cat 对象扩展而来的新对象                        | 基于原型 OOP 中的原型对象 |
| 小白对象中包含了数据和基于这些数据的方法                     | 封装                      |
| 小白只是整个猫家族对象的一部分，还有小橘、小黑               | 聚合、组合                |
| 小橘、小黑都是分别扩展自 Cat 对象的新对象                    | 继承                      |
| 我们可以随时调用小白、小橘、小黑各自的 eat 方法，它们都可以正常工作，尽管这些方法会产生不同的结果（如小白吃的是猫粮，小橘吃的是罐头，小黑吃的是鱼干），总之，每个对象都可以重新定义它们的继承方法 eat | 多态、方法覆写            |

